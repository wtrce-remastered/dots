#!/usr/bin/env bash

# I'M ROOT

if [[ $EUID -ne 0 ]]; then
    echo "Run this script as root"
    exit 1
fi

# DEF

CON_BOX_PATH="/var/rsd/containers"
CON_CONFIGS_PATH="/etc/systemd/nspawn"

# ARGUMENTS

con_name="$1"
if [ -z "$con_name" ]; then
    echo "Usage: $0 <container_name>"
    exit 1
fi

CON_PATH="$CON_BOX_PATH/$con_name"
if ! [ -d "$CON_PATH" ]; then
    echo "Container '$CON_PATH' does not exists"
    exit 1
fi

# REMOVING

rm -rf "$CON_PATH" && rm -f "$con_configs_path/$con_name"
